{"ast":null,"code":"import _toConsumableArray from\"/Users/raphael/Documents/Github/FrontSistemadoPerito/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/raphael/Documents/Github/FrontSistemadoPerito/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{configure}from'axios-hooks';import{getToken}from'Utils/user_token';import{message}from'antd';import Axios from'axios';import errorModal from'Utils/errorModal';import store from'Redux/UserReducer';var dispatch=store.dispatch;var baseURL=process.env.NODE_ENV==='production'?'http://test.sistemadoperito.com.br/':'http://test.sistemadoperito.com.br/';var DEFAULT_CONFIGURATION={baseURL:baseURL,timeout:60000};export var setupAxios=function setupAxios(){var axios=Axios.create(DEFAULT_CONFIGURATION);configure({axios:axios});};var logoutUser=function logoutUser(raw_data){try{var data=JSON.parse(raw_data);if(!data.success&&data.key==='erro_token'){localStorage.removeItem('token');setTimeout(message.destroy,100);errorModal({content:data.message},3000);setTimeout(function(){return window.location.href='/login';},2500);}if(!data.success&&data.key==='trial_off'&&!window.location.href.includes('/plans')){setTimeout(message.destroy,100);errorModal({content:data.message},2500);setTimeout(function(){return window.location.href='/plans';},2500);}if(!data.success&&data.key==='payment_open'){if(!window.location.href.includes('/billing')){dispatch({type:'SET_HAS_OPEN_PAYMENTS',payload:true});setTimeout(message.destroy,100);errorModal({content:data.message},3000);setTimeout(function(){return window.location.href='/billing';},2500);}}}catch(error){/* ignore error */}return raw_data;};export var setAxiosToken=function setAxiosToken(){var _getToken;var transform_response=Axios.defaults.transformResponse;if(transform_response===undefined)transform_response=[];if(!Array.isArray(transform_response))transform_response=[transform_response];var token=(_getToken=getToken())===null||_getToken===void 0?void 0:_getToken.token;var axios=Axios.create(_objectSpread({},DEFAULT_CONFIGURATION,{headers:{authorization:\"Bearer \".concat(token),'Content-Type':'application/json'},transformResponse:[function(raw_data){return logoutUser(raw_data);}].concat(_toConsumableArray(transform_response))}));configure({axios:axios});};var api=Axios.create(_objectSpread({},DEFAULT_CONFIGURATION));export default api;","map":null,"metadata":{},"sourceType":"module"}