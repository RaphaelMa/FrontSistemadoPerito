{"ast":null,"code":"import _defineProperty from\"/Users/raphael/Documents/Github/FrontSistemadoPerito/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/raphael/Documents/Github/FrontSistemadoPerito/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/raphael/Documents/Github/FrontSistemadoPerito/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,memo,useMemo,useCallback,useEffect,useRef}from'react';import{uniqBy}from'lodash';import ContainerList from'Components/MainList/ContainerList';import HistoryTable from'./HistoryTable';import useGetHistories from'./useGetHistories';import Header from'./Header';import TableContainer from'../../Components/MainList/TableContainer';var History=function History(){var _useState=useState({dates:[],user_id:null,action_id:null,module_id:null}),_useState2=_slicedToArray(_useState,2),filters=_useState2[0],setFilters=_useState2[1];var _useGetHistories=useGetHistories(),_useGetHistories2=_slicedToArray(_useGetHistories,2),_useGetHistories2$=_useGetHistories2[0],loading=_useGetHistories2$.loading,data=_useGetHistories2$.data,fetchHistories=_useGetHistories2[1];useEffect(function(){fetchHistories();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);var handleChangeFilters=useCallback(function(type,value){var new_filters=_objectSpread({},filters,_defineProperty({},type,value));setFilters(new_filters);},[filters]);var histories=data||[];var filteredHistories=useCallback(function(){return histories.filter(function(history){if(filters.dates[0]&&(!history.createAt||history.createAt<filters.dates[0]))return false;if(filters.dates[1]&&(!history.createAt||history.createAt>filters.dates[1]))return false;if(filters.user_id&&history.user.user_id!==filters.user_id)return false;if(filters.action_id&&history.action.action_id!==filters.action_id)return false;if(filters.module_id&&history.module.module_id!==filters.module_id)return false;return true;});},[filters.action_id,filters.dates,filters.module_id,filters.user_id,histories]);var modules=useMemo(function(){return histories.map(function(history){return history.module;});},[histories]);var non_duplicated_modules=useMemo(function(){return uniqBy(modules,'module_id').filter(function(module){return module.module_id;});},[modules]);var actions=histories.map(function(history){return history.action;});var non_duplicated_actions=useMemo(function(){return uniqBy(actions,'action_id').filter(function(action){return action.action_id;});},[actions]);var divRef=useRef(null);return/*#__PURE__*/React.createElement(ContainerList,null,/*#__PURE__*/React.createElement(Header,{handleChangeFilters:handleChangeFilters,modules:non_duplicated_modules,actions:non_duplicated_actions}),/*#__PURE__*/React.createElement(TableContainer,{divRef:divRef},/*#__PURE__*/React.createElement(HistoryTable,{data:filteredHistories(),loading:loading,divRef:divRef})));};History.displayName=\"History\";export default memo(History);","map":null,"metadata":{},"sourceType":"module"}