{"ast":null,"code":"import _objectSpread from\"/Users/raphael/Documents/Github/FrontSistemadoPerito/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/Users/raphael/Documents/Github/FrontSistemadoPerito/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/raphael/Documents/Github/FrontSistemadoPerito/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectWithoutProperties from\"/Users/raphael/Documents/Github/FrontSistemadoPerito/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import React,{useEffect,useRef,memo}from'react';import{Select,Divider,Tag}from'antd';import{UnstyledButton}from'Components/SistemaDoPerito';import{PlusOutlined}from'@ant-design/icons';import{deburr,isEqual}from'lodash';import useGetPeople from'./useGetPeople';import useGetUsers from'./useGetUsers';import PersonDrawer from'Components/Drawers/Person/Person';import{useUserSelector}from'Redux/UserReducer';// TODO: Ajustar props\nvar PeopleInput=function PeopleInput(props){var _props$with_users=props.with_users,with_users=_props$with_users===void 0?false:_props$with_users,query_options=props.query_options,show_create_button=props.show_create_button,person_options=props.person_options,_props$fetch_options=props.fetch_options,fetch_options=_props$fetch_options===void 0?true:_props$fetch_options,refetch=props.refetch,external_loading=props.external_loading,rest=_objectWithoutProperties(props,[\"with_users\",\"query_options\",\"show_create_button\",\"person_options\",\"fetch_options\",\"refetch\",\"external_loading\"]);var plan_modules=useUserSelector(function(state){var _state$company;return(_state$company=state.company)===null||_state$company===void 0?void 0:_state$company.plan.modules;});var permissions=useUserSelector(function(state){return state.permissions;});var personDrawerRef=useRef(null);var _useGetPeople=useGetPeople(),_useGetPeople2=_slicedToArray(_useGetPeople,2),_useGetPeople2$=_useGetPeople2[0],_useGetPeople2$$data=_useGetPeople2$.data,people=_useGetPeople2$$data===void 0?[]:_useGetPeople2$$data,people_loading=_useGetPeople2$.loading,getPeople=_useGetPeople2[1];var _useGetUsers=useGetUsers(),_useGetUsers2=_slicedToArray(_useGetUsers,2),_useGetUsers2$=_useGetUsers2[0],_useGetUsers2$$data=_useGetUsers2$.data,users=_useGetUsers2$$data===void 0?[]:_useGetUsers2$$data,users_loading=_useGetUsers2$.loading,getUsers=_useGetUsers2[1];var all_data=_toConsumableArray(person_options||[]);people.forEach(function(person){return all_data.push(_objectSpread({},person,{type:'people'}));});users.forEach(function(user){return all_data.push(_objectSpread({},user,{type:'user'}));});useEffect(function(){if(fetch_options){getPeople();if(with_users)getUsers();}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[with_users]);var onCreateClick=function onCreateClick(){var _personDrawerRef$curr;(_personDrawerRef$curr=personDrawerRef.current)===null||_personDrawerRef$curr===void 0?void 0:_personDrawerRef$curr.open();};var afterSave=function afterSave(people){if(fetch_options||typeof refetch==='undefined'){getPeople();console.log('[PersonInput] Normal');}else{refetch();console.log('[PersonInput] Refetch');}var value=props.mode==='multiple'||props.mode==='tags'?[].concat(_toConsumableArray(props.value),[people._id]):people._id;if(props.onChange)props.onChange(value,{children:people.name,value:people._id});};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Select,Object.assign({style:{width:'100%'},loading:people_loading||users_loading||external_loading,placeholder:\"Pessoa\",showSearch:true,filterOption:function filterOption(raw_value,option){var value=deburr(raw_value).toLowerCase();var option_value=deburr(option===null||option===void 0?void 0:option.name).toLowerCase();return option_value.indexOf(value)>=0;},dropdownRender:function dropdownRender(menu){return/*#__PURE__*/React.createElement(\"div\",null,menu,show_create_button&&(plan_modules===null||plan_modules===void 0?void 0:plan_modules.Register)&&(permissions===null||permissions===void 0?void 0:permissions.people.create)&&/*#__PURE__*/React.createElement(UnstyledButton,{style:{display:'block',padding:8},className:\"no-decoration\",onClick:onCreateClick},/*#__PURE__*/React.createElement(PlusOutlined,null),\" Nova pessoa\"));}},rest),all_data.map(function(person){return/*#__PURE__*/React.createElement(Select.Option,{key:person._id,value:person._id,name:person.name},/*#__PURE__*/React.createElement(\"div\",{title:person.name},with_users&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Tag,{color:person.type==='people'?'blue':'red'},person.type==='people'?'Pessoa':'Usu√°rio'),/*#__PURE__*/React.createElement(Divider,{type:\"vertical\"})),person.name));})),/*#__PURE__*/React.createElement(PersonDrawer,{ref:personDrawerRef,afterSave:afterSave}));};export default memo(PeopleInput,isEqual);","map":null,"metadata":{},"sourceType":"module"}