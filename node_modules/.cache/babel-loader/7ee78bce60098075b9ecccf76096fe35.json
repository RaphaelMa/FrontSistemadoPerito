{"ast":null,"code":"(function () {\n  var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;\n  enterModule && enterModule(module);\n})();\n\nvar __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {\n  return a;\n};\n\nimport api from 'Utils/axios_configuration';\nimport messageError from 'Utils/messageError';\nimport store from './UserReducer';\nimport { getToken } from 'Utils/user_token';\nconst {\n  dispatch\n} = store;\nconst default_permissions = {\n  attachment: {\n    create: true,\n    read: true,\n    delete: true\n  },\n  billing: {\n    read: true\n  },\n  company: {\n    read: true,\n    update: true\n  },\n  dashboard: {\n    read: true\n  },\n  document: {\n    create: true,\n    read: true,\n    update: true,\n    delete: true\n  },\n  financial: {\n    create: true,\n    read: true,\n    update: true,\n    delete: true\n  },\n  historic: {\n    read: true\n  },\n  judicialdistrict: {\n    create: true,\n    read: true,\n    update: true,\n    delete: true\n  },\n  keyWord: {\n    create: true,\n    read: true,\n    update: true,\n    delete: true\n  },\n  kindPeople: {\n    create: true,\n    read: true,\n    update: true,\n    delete: true\n  },\n  notification: {\n    read: true,\n    update: true\n  },\n  people: {\n    create: true,\n    read: true,\n    update: true,\n    delete: true\n  },\n  peoplemanagement: {\n    read: true\n  },\n  plan: {\n    read: true,\n    update: true\n  },\n  process: {\n    create: true,\n    read: true,\n    update: true,\n    delete: true\n  },\n  processFinancialSituation: {\n    create: true,\n    read: true,\n    update: true,\n    delete: true\n  },\n  processNature: {\n    create: true,\n    read: true,\n    update: true,\n    delete: true\n  },\n  processSituation: {\n    create: true,\n    read: true,\n    update: true,\n    delete: true\n  },\n  report: {\n    read: true\n  },\n  schedule: {\n    read: true,\n    update: true\n  },\n  task: {\n    create: true,\n    read: true,\n    update: true,\n    delete: true\n  },\n  taskAutomation: {\n    create: true,\n    read: true,\n    update: true,\n    delete: true\n  },\n  user: {\n    create: true,\n    read: true,\n    update: true,\n    delete: true\n  }\n};\nexport const fetchInitalData = async () => {\n  var _getToken;\n\n  const token = (_getToken = getToken()) === null || _getToken === void 0 ? void 0 : _getToken.token; // Pasando o token pq tem um delay até o axios setar o token, assim garante que sempre vai dar certo.\n\n  const company_query = api.get('/company', {\n    headers: {\n      authorization: `Bearer ${token}`\n    }\n  }); // const current_user_query =  api.get<CompanyRequestType>('/current_user', { headers: { authorization: `Bearer ${token}` } })\n\n  dispatch({\n    type: 'SET_LOADING',\n    payload: true\n  });\n\n  try {\n    var _response$, _response$2, _response$2$data;\n\n    const response = await Promise.all([company_query]);\n    const {\n      success,\n      key\n    } = response[0].data;\n\n    if (!success && key === 'activeCode') {\n      dispatch({\n        type: 'SET_ACTIVE_ACCOUNT',\n        payload: false\n      });\n      dispatch({\n        type: 'SET_LOADING',\n        payload: false\n      });\n      return;\n    }\n\n    const company = (_response$ = response[0]) === null || _response$ === void 0 ? void 0 : _response$.data;\n    const trial = (_response$2 = response[0]) === null || _response$2 === void 0 ? void 0 : (_response$2$data = _response$2.data) === null || _response$2$data === void 0 ? void 0 : _response$2$data.trial;\n    const trial_rest_days = await fetchTrialDays(trial, token);\n    const current_user = await fetchCurrentUser(token);\n    const permissions = (current_user === null || current_user === void 0 ? void 0 : current_user.acecessPermission) || default_permissions;\n    const birthday = (current_user === null || current_user === void 0 ? void 0 : current_user.birthday) || '';\n    const userName = (current_user === null || current_user === void 0 ? void 0 : current_user.name) || '';\n    const kindUser = (current_user === null || current_user === void 0 ? void 0 : current_user.kindUser) || {\n      kindUser_id: '',\n      kindUser_description: '',\n      kindUser_key: ''\n    };\n    dispatch({\n      type: 'SET_INITIAL_DATA',\n      payload: {\n        company,\n        trial_rest_days: trial_rest_days,\n        permissions: permissions,\n        birthday: birthday,\n        kindUser: kindUser,\n        userName: userName\n      }\n    });\n  } catch (error) {\n    console.log(error);\n    messageError('202010311855');\n    dispatch({\n      type: 'SET_LOADING',\n      payload: false\n    });\n  }\n};\n\nconst fetchTrialDays = async (trial, token) => {\n  if (!trial) return 0;\n\n  try {\n    // Pasando o token pq tem um delay até o axios setar o token, assim garante que sempre vai dar certo.\n    const {\n      data\n    } = await api.get('/trial', {\n      headers: {\n        authorization: `Bearer ${token}`\n      }\n    });\n    const {\n      success,\n      restDays\n    } = data;\n    if (!success) return 0;\n    return restDays;\n  } catch (error) {\n    return 0;\n  }\n};\n\nconst fetchCurrentUser = async token => {\n  try {\n    const {\n      data\n    } = await api.get('/currentuser', {\n      headers: {\n        authorization: `Bearer ${token}`\n      }\n    });\n    return data;\n  } catch (error) {\n    return null;\n  }\n};\n\nexport const userLogin = async ({\n  remember,\n  ...user\n}) => {\n  var _response, _response3, _response4;\n\n  let response = null;\n  dispatch({\n    type: 'SET_LOADING',\n    payload: true\n  });\n\n  try {\n    response = await api.post('/session', { ...user\n    });\n  } catch (error) {\n    messageError('202008151654');\n    dispatch({\n      type: 'SET_LOADING',\n      payload: false\n    });\n    return;\n  }\n\n  const success = (_response = response) === null || _response === void 0 ? void 0 : _response.data.success;\n\n  if (success) {\n    var _response2;\n\n    const token = ((_response2 = response) === null || _response2 === void 0 ? void 0 : _response2.data.token) || '';\n    dispatch({\n      type: 'LOGIN',\n      payload: {\n        token,\n        remember\n      }\n    });\n    return Promise.resolve();\n  }\n\n  dispatch({\n    type: 'SET_LOADING',\n    payload: false\n  });\n  return Promise.reject({\n    key: (_response3 = response) === null || _response3 === void 0 ? void 0 : _response3.data.key,\n    message: (_response4 = response) === null || _response4 === void 0 ? void 0 : _response4.data.message\n  });\n};\nexport const updateCompanyData = async () => {\n  var _getToken2;\n\n  const token = (_getToken2 = getToken()) === null || _getToken2 === void 0 ? void 0 : _getToken2.token; // Pasando o token pq tem um delay até o axios setar o token, assim garante que sempre vai dar certo.\n\n  const response = await api.get('/company', {\n    headers: {\n      authorization: `Bearer ${token}`\n    }\n  });\n  const company = response.data;\n  dispatch({\n    type: 'UPDATE_COMPANY',\n    payload: company\n  });\n};\n;\n\n(function () {\n  var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(dispatch, \"dispatch\", \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Redux/fetchActions.ts\");\n  reactHotLoader.register(default_permissions, \"default_permissions\", \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Redux/fetchActions.ts\");\n  reactHotLoader.register(fetchInitalData, \"fetchInitalData\", \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Redux/fetchActions.ts\");\n  reactHotLoader.register(fetchTrialDays, \"fetchTrialDays\", \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Redux/fetchActions.ts\");\n  reactHotLoader.register(fetchCurrentUser, \"fetchCurrentUser\", \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Redux/fetchActions.ts\");\n  reactHotLoader.register(userLogin, \"userLogin\", \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Redux/fetchActions.ts\");\n  reactHotLoader.register(updateCompanyData, \"updateCompanyData\", \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Redux/fetchActions.ts\");\n})();\n\n;\n\n(function () {\n  var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;\n  leaveModule && leaveModule(module);\n})();","map":{"version":3,"sources":["/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Redux/fetchActions.ts"],"names":["api","messageError","store","getToken","dispatch","default_permissions","attachment","create","read","delete","billing","company","update","dashboard","document","financial","historic","judicialdistrict","keyWord","kindPeople","notification","people","peoplemanagement","plan","process","processFinancialSituation","processNature","processSituation","report","schedule","task","taskAutomation","user","fetchInitalData","token","company_query","get","headers","authorization","type","payload","response","Promise","all","success","key","data","trial","trial_rest_days","fetchTrialDays","current_user","fetchCurrentUser","permissions","acecessPermission","birthday","userName","name","kindUser","kindUser_id","kindUser_description","kindUser_key","error","console","log","restDays","userLogin","remember","post","resolve","reject","message","updateCompanyData"],"mappings":"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","sourcesContent":["import api from 'Utils/axios_configuration'\nimport messageError from 'Utils/messageError'\nimport store from './UserReducer'\nimport { getToken } from 'Utils/user_token'\nimport { CompanyType, CurrentUserPayloadType } from './Types'\n\nconst { dispatch } = store\n\ntype CompanyRequestType = {\n  key: string,\n  message: string,\n  success: boolean,\n} & CompanyType\n\nconst default_permissions = {\n  attachment: { create: true, read: true, delete: true },\n  billing: { read: true },\n  company: { read: true, update: true },\n  dashboard: { read: true },\n  document: { create: true, read: true, update: true, delete: true },\n  financial: { create: true, read: true, update: true, delete: true },\n  historic: { read: true },\n  judicialdistrict: { create: true, read: true, update: true, delete: true },\n  keyWord: { create: true, read: true, update: true, delete: true },\n  kindPeople: { create: true, read: true, update: true, delete: true },\n  notification: { read: true, update: true },\n  people: { create: true, read: true, update: true, delete: true },\n  peoplemanagement: { read: true },\n  plan: { read: true, update: true },\n  process: { create: true, read: true, update: true, delete: true },\n  processFinancialSituation: { create: true, read: true, update: true, delete: true },\n  processNature: { create: true, read: true, update: true, delete: true },\n  processSituation: { create: true, read: true, update: true, delete: true },\n  report: { read: true },\n  schedule: { read: true, update: true },\n  task: { create: true, read: true, update: true, delete: true },\n  taskAutomation: { create: true, read: true, update: true, delete: true },\n  user: { create: true, read: true, update: true, delete: true },\n}\n\nexport const fetchInitalData = async () => {\n  const token = getToken()?.token\n  // Pasando o token pq tem um delay até o axios setar o token, assim garante que sempre vai dar certo.\n  const company_query =  api.get<CompanyRequestType>('/company', { headers: { authorization: `Bearer ${token}` } })\n  // const current_user_query =  api.get<CompanyRequestType>('/current_user', { headers: { authorization: `Bearer ${token}` } })\n  dispatch({ type: 'SET_LOADING', payload: true })\n\n  try {\n    const response = await Promise.all([company_query])\n    const { success, key } = response[0].data\n    if (!success && key === 'activeCode') {\n      dispatch({ type: 'SET_ACTIVE_ACCOUNT', payload: false })\n      dispatch({ type: 'SET_LOADING', payload: false })\n      return\n    }\n\n    const company = response[0]?.data\n    const trial = response[0]?.data?.trial\n    const trial_rest_days = await fetchTrialDays(trial, token)\n    const current_user = await fetchCurrentUser(token)\n\n    const permissions = current_user?.acecessPermission || default_permissions\n    const birthday = current_user?.birthday || ''\n    const userName = current_user?.name || ''\n   \n    const kindUser = current_user?.kindUser || {kindUser_id: '', kindUser_description: '', kindUser_key: ''}\n\n    dispatch({ type: 'SET_INITIAL_DATA',  payload: { company, trial_rest_days: trial_rest_days, permissions: permissions, birthday: birthday, kindUser: kindUser, userName: userName } })\n  } catch (error) {\n    console.log(error)\n    messageError('202010311855')\n    dispatch({ type: 'SET_LOADING', payload: false })\n  }\n}\n\nconst fetchTrialDays = async (trial: boolean, token?: string) => {\n  if (!trial) return 0\n\n  try {\n    // Pasando o token pq tem um delay até o axios setar o token, assim garante que sempre vai dar certo.\n    const { data } =  await api.get<{ success: boolean, restDays: number }>('/trial', { headers: { authorization: `Bearer ${token}` } })\n    const { success, restDays } = data\n    if (!success) return 0\n\n    return restDays\n  } catch (error) {\n    return 0;\n  }\n}\n\nconst fetchCurrentUser = async (token?: string) => {\n  try {\n    const { data } =  await api.get<CurrentUserPayloadType>('/currentuser', { headers: { authorization: `Bearer ${token}` } })\n\n    return data\n  } catch (error) {\n    return null\n  }\n}\n\ntype UserLoginVars = {\n  remember: boolean,\n  email: string,\n  password: string,\n}\n\ntype LoginPayload = {\n  success: boolean,\n  token?: string,\n  email?: string,\n  key?: string,\n  message?: string,\n}\n\nexport const userLogin = async ({ remember, ...user }: UserLoginVars) => {\n  let response = null\n  dispatch({ type: 'SET_LOADING', payload: true })\n\n  try {\n    response = await api.post<LoginPayload>('/session', { ...user })\n  } catch (error) {\n    messageError('202008151654')\n    dispatch({ type: 'SET_LOADING', payload: false })\n    return\n  }\n\n  const success = response?.data.success\n  if (success) {\n    const token = response?.data.token || ''\n\n    dispatch({ type: 'LOGIN', payload: { token, remember } })\n    return Promise.resolve()\n  }\n\n  dispatch({ type: 'SET_LOADING', payload: false })\n  return Promise.reject({ key: response?.data.key, message: response?.data.message })\n}\n\nexport const updateCompanyData = async () => {\n  const token = getToken()?.token\n  // Pasando o token pq tem um delay até o axios setar o token, assim garante que sempre vai dar certo.\n  const response = await api.get<CompanyRequestType>('/company', { headers: { authorization: `Bearer ${token}` } })\n\n  const company = response.data\n  dispatch({ type: 'UPDATE_COMPANY',  payload: company })\n}\n"]},"metadata":{},"sourceType":"module"}