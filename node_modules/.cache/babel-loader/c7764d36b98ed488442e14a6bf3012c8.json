{"ast":null,"code":"(function () {\n  var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;\n  enterModule && enterModule(module);\n})();\n\nvar __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {\n  return a;\n};\n\nimport moment from 'moment';\nimport { AES, enc } from 'crypto-js';\nconst PHRASE = 'C6A22DF796E9DC5DC612545B82FA7C5F529F3FE764931A00468E1AC221DAA792';\nexport const setToken = (raw_token, remember) => {\n  const expires_date = remember ? moment().add(7, 'days').format() : moment().add(1, 'day').format();\n\n  try {\n    const token = AES.encrypt(raw_token, PHRASE).toString();\n    window.localStorage.setItem('token', JSON.stringify({\n      expires_at: expires_date,\n      remember,\n      data: token\n    }));\n  } catch (_error) {\n    // Ignora erro mesmo\n    console.log(_error);\n    return null;\n  }\n};\nexport const getToken = () => {\n  const raw_value = window.localStorage.getItem('token');\n  if (!raw_value) return null;\n\n  try {\n    const value = JSON.parse(raw_value);\n    const {\n      remember,\n      data,\n      expires_at\n    } = value;\n\n    if (moment(expires_at).isBefore()) {\n      window.localStorage.removeItem('token'); // Limpa o token\n\n      return null;\n    }\n\n    const token = AES.decrypt(data, PHRASE).toString(enc.Utf8);\n    return {\n      token,\n      remember\n    };\n  } catch (_error) {\n    return null;\n  }\n};\nexport const updatesTokenExpiration = () => {\n  const data = getToken();\n  if (!data) return;\n  const {\n    token,\n    remember\n  } = data;\n  setToken(token, remember); // Reseta o tempo do token\n};\n;\n\n(function () {\n  var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(PHRASE, \"PHRASE\", \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Utils/user_token.ts\");\n  reactHotLoader.register(setToken, \"setToken\", \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Utils/user_token.ts\");\n  reactHotLoader.register(getToken, \"getToken\", \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Utils/user_token.ts\");\n  reactHotLoader.register(updatesTokenExpiration, \"updatesTokenExpiration\", \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Utils/user_token.ts\");\n})();\n\n;\n\n(function () {\n  var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;\n  leaveModule && leaveModule(module);\n})();","map":{"version":3,"sources":["/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Utils/user_token.ts"],"names":["moment","AES","enc","PHRASE","setToken","raw_token","remember","expires_date","add","format","token","encrypt","toString","window","localStorage","setItem","JSON","stringify","expires_at","data","_error","console","log","getToken","raw_value","getItem","value","parse","isBefore","removeItem","decrypt","Utf8","updatesTokenExpiration"],"mappings":";;;;;;;;;AAAA,OAAOA,MAAP,MAAmB,QAAnB;AACA,SAASC,GAAT,EAAcC,GAAd,QAAyB,WAAzB;AAEA,MAAMC,MAAM,GAAG,kEAAf;AAEA,OAAO,MAAMC,QAAQ,GAAG,CAACC,SAAD,EAAoBC,QAApB,KAA0C;AAChE,QAAMC,YAAY,GAAGD,QAAQ,GAAGN,MAAM,GAAGQ,GAAT,CAAa,CAAb,EAAgB,MAAhB,EAAwBC,MAAxB,EAAH,GAAsCT,MAAM,GAAGQ,GAAT,CAAa,CAAb,EAAgB,KAAhB,EAAuBC,MAAvB,EAAnE;;AAEA,MAAI;AACF,UAAMC,KAAK,GAAGT,GAAG,CAACU,OAAJ,CAAYN,SAAZ,EAAuBF,MAAvB,EAA+BS,QAA/B,EAAd;AAEAC,IAAAA,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,OAA5B,EAAqCC,IAAI,CAACC,SAAL,CAAe;AAAEC,MAAAA,UAAU,EAAEX,YAAd;AAA4BD,MAAAA,QAA5B;AAAsCa,MAAAA,IAAI,EAAET;AAA5C,KAAf,CAArC;AACD,GAJD,CAIE,OAAOU,MAAP,EAAe;AACf;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAYF,MAAZ;AACA,WAAO,IAAP;AACD;AACF,CAZM;AAcP,OAAO,MAAMG,QAAQ,GAAG,MAAmD;AACzE,QAAMC,SAAS,GAAGX,MAAM,CAACC,YAAP,CAAoBW,OAApB,CAA4B,OAA5B,CAAlB;AACA,MAAI,CAACD,SAAL,EAAgB,OAAO,IAAP;;AAEhB,MAAI;AACF,UAAME,KAAK,GAAGV,IAAI,CAACW,KAAL,CAAWH,SAAX,CAAd;AACA,UAAM;AAAElB,MAAAA,QAAF;AAAYa,MAAAA,IAAZ;AAAkBD,MAAAA;AAAlB,QAAiCQ,KAAvC;;AAEA,QAAI1B,MAAM,CAACkB,UAAD,CAAN,CAAmBU,QAAnB,EAAJ,EAAmC;AACjCf,MAAAA,MAAM,CAACC,YAAP,CAAoBe,UAApB,CAA+B,OAA/B,EADiC,CACO;;AACxC,aAAO,IAAP;AACD;;AAED,UAAMnB,KAAK,GAAGT,GAAG,CAAC6B,OAAJ,CAAYX,IAAZ,EAAkBhB,MAAlB,EAA0BS,QAA1B,CAAmCV,GAAG,CAAC6B,IAAvC,CAAd;AAEA,WAAO;AAAErB,MAAAA,KAAF;AAASJ,MAAAA;AAAT,KAAP;AACD,GAZD,CAYE,OAAOc,MAAP,EAAe;AACf,WAAO,IAAP;AACD;AACF,CAnBM;AAqBP,OAAO,MAAMY,sBAAsB,GAAG,MAAM;AAC1C,QAAMb,IAAI,GAAGI,QAAQ,EAArB;AACA,MAAI,CAACJ,IAAL,EAAW;AAEX,QAAM;AAAET,IAAAA,KAAF;AAASJ,IAAAA;AAAT,MAAsBa,IAA5B;AACAf,EAAAA,QAAQ,CAACM,KAAD,EAAQJ,QAAR,CAAR,CAL0C,CAKhB;AAC3B,CANM;;;;;;;;;;0BArCDH,M;0BAEOC,Q;0BAcAmB,Q;0BAqBAS,sB","sourcesContent":["import moment from 'moment'\nimport { AES, enc } from 'crypto-js'\n\nconst PHRASE = 'C6A22DF796E9DC5DC612545B82FA7C5F529F3FE764931A00468E1AC221DAA792'\n\nexport const setToken = (raw_token: string, remember: boolean) => {\n  const expires_date = remember ? moment().add(7, 'days').format() : moment().add(1, 'day').format()\n\n  try {\n    const token = AES.encrypt(raw_token, PHRASE).toString()\n\n    window.localStorage.setItem('token', JSON.stringify({ expires_at: expires_date, remember, data: token }))\n  } catch (_error) {\n    // Ignora erro mesmo\n    console.log(_error)\n    return null\n  }\n}\n\nexport const getToken = (): { token: string, remember: boolean } | null => {\n  const raw_value = window.localStorage.getItem('token')\n  if (!raw_value) return null\n\n  try {\n    const value = JSON.parse(raw_value)\n    const { remember, data, expires_at } = value\n\n    if (moment(expires_at).isBefore()) {\n      window.localStorage.removeItem('token') // Limpa o token\n      return null\n    }\n\n    const token = AES.decrypt(data, PHRASE).toString(enc.Utf8)\n\n    return { token, remember }\n  } catch (_error) {\n    return null\n  }\n}\n\nexport const updatesTokenExpiration = () => {\n  const data = getToken()\n  if (!data) return\n\n  const { token, remember } = data\n  setToken(token, remember) // Reseta o tempo do token\n}\n"]},"metadata":{},"sourceType":"module"}