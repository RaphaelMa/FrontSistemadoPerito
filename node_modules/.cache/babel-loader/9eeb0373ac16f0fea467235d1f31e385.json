{"ast":null,"code":"import _regeneratorRuntime from\"/Users/raphael/Documents/Github/FrontSistemadoPerito/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/raphael/Documents/Github/FrontSistemadoPerito/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/Users/raphael/Documents/Github/FrontSistemadoPerito/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/raphael/Documents/Github/FrontSistemadoPerito/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect}from'react';import{Form,Row,Space,Button,Modal,message}from'antd';import{useUserSelector,useUserDispatch}from'Redux/UserReducer';import{updateCompanyData}from'Redux/fetchActions';import styled from'styled-components';import CompanyForm from'./CompanyForm';import messageError from'Utils/messageError';import successModal from'Utils/successModal';import useSaveCompany from'./useSaveCompany';import PlanInformation from'./PlanInformation';var Company=function Company(){var company=useUserSelector(function(state){return state.company;});var permissions=useUserSelector(function(state){return state.permissions;});var _Form$useForm=Form.useForm(),_Form$useForm2=_slicedToArray(_Form$useForm,1),form=_Form$useForm2[0];var setFieldsValue=form.setFieldsValue;var _useSaveCompany=useSaveCompany(),_useSaveCompany2=_slicedToArray(_useSaveCompany,2),saveCompany=_useSaveCompany2[0],loading=_useSaveCompany2[1].loading;var dispatch=useUserDispatch();var _ref=company||{},active=_ref.active;useEffect(function(){// Faz o refetch dos dados quando entra, s√≥ para manter os dados sempre atualizados\n// TODO: Buscar somente os dados da empresa\nupdateCompanyData();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);useEffect(function(){form.setFieldsValue(_objectSpread({},company,{plan_id:company===null||company===void 0?void 0:company.plan.plan_id}));// eslint-disable-next-line react-hooks/exhaustive-deps\n},[company]);var handleFormFinish=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(values){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return saveCompany(values);case 3:response=_context.sent;if(!response.data.success){_context.next=8;break;}successModal({content:'Empresa salva com sucesso'});dispatch({type:'UPDATE_COMPANY',payload:response.data.company});return _context.abrupt(\"return\");case 8:message.error(response.data.message);_context.next=15;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);messageError('202010312007');console.log('[Company] ',_context.t0);case 15:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);}));return function handleFormFinish(_x){return _ref2.apply(this,arguments);};}();var confirmStatusChange=function confirmStatusChange(active_company){Modal.confirm({title:/*#__PURE__*/React.createElement(\"span\",null,\"A conta ser\\xE1 \",active_company?'ativada':'desativada',\"!\",/*#__PURE__*/React.createElement(\"br\",null),\"Deseja continuar?\"),okText:'Sim',onOk:function onOk(){return changeCompanyStatus(active_company);}});};var changeCompanyStatus=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(active_company){var form_values,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return form.validateFields();case 2:form_values=_context2.sent;_context2.prev=3;_context2.next=6;return saveCompany(_objectSpread({},form_values,{active:active_company}));case 6:response=_context2.sent;if(!response.data.success){_context2.next=11;break;}successModal({content:\"Empresa \".concat(active_company?'ativado':'desativado',\" com sucesso\")});dispatch({type:'UPDATE_COMPANY',payload:response.data.company});return _context2.abrupt(\"return\");case 11:message.error(response.data.message);_context2.next=18;break;case 14:_context2.prev=14;_context2.t0=_context2[\"catch\"](3);messageError('202010312014');console.log('[Company] ',_context2.t0);case 18:case\"end\":return _context2.stop();}}},_callee2,null,[[3,14]]);}));return function changeCompanyStatus(_x2){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(Form,{form:form,layout:\"vertical\",onFinish:handleFormFinish},/*#__PURE__*/React.createElement(FormContainer,null,/*#__PURE__*/React.createElement(CompanyForm,{width:40,setFieldsValue:setFieldsValue}),/*#__PURE__*/React.createElement(PlanInformation,null)),(permissions===null||permissions===void 0?void 0:permissions.company.update)&&/*#__PURE__*/React.createElement(Footer,{justify:\"end\"},/*#__PURE__*/React.createElement(Space,null,/*#__PURE__*/React.createElement(Button,{disabled:loading,loading:loading,type:\"primary\",htmlType:\"submit\"},\"Salvar\"),active?/*#__PURE__*/React.createElement(Button,{disabled:loading,loading:loading,onClick:function onClick(){return confirmStatusChange(false);}},\"Desativar\"):/*#__PURE__*/React.createElement(Button,{disabled:loading,loading:loading,onClick:function onClick(){return confirmStatusChange(true);}},\"Ativar\")))));};Company.displayName=\"Company\";export default Company;var Container=styled.div.withConfig({displayName:\"Company__Container\",componentId:\"sc-1xv2pxp-0\"})([\"overflow-y:auto;overflow-x:hidden;padding:20px 40px;height:calc(100% - 5rem);\"]);var FormContainer=styled.div.withConfig({displayName:\"Company__FormContainer\",componentId:\"sc-1xv2pxp-1\"})([\"display:flex;\"]);var Footer=styled(Row).withConfig({displayName:\"Company__Footer\",componentId:\"sc-1xv2pxp-2\"})([\"width:100%;position:sticky;bottom:0;background:white;padding:8px 0;padding-bottom:24px;\"]);","map":null,"metadata":{},"sourceType":"module"}