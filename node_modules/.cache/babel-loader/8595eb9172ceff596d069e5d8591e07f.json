{"ast":null,"code":"import _objectSpread from\"/Users/raphael/Documents/Github/FrontSistemadoPerito/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _objectWithoutProperties from\"/Users/raphael/Documents/Github/FrontSistemadoPerito/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import _regeneratorRuntime from\"/Users/raphael/Documents/Github/FrontSistemadoPerito/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/raphael/Documents/Github/FrontSistemadoPerito/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import api from'Utils/axios_configuration';import messageError from'Utils/messageError';import store from'./UserReducer';import{getToken}from'Utils/user_token';var dispatch=store.dispatch;var default_permissions={attachment:{create:true,read:true,delete:true},billing:{read:true},company:{read:true,update:true},dashboard:{read:true},document:{create:true,read:true,update:true,delete:true},financial:{create:true,read:true,update:true,delete:true},historic:{read:true},judicialdistrict:{create:true,read:true,update:true,delete:true},keyWord:{create:true,read:true,update:true,delete:true},kindPeople:{create:true,read:true,update:true,delete:true},notification:{read:true,update:true},people:{create:true,read:true,update:true,delete:true},peoplemanagement:{read:true},plan:{read:true,update:true},process:{create:true,read:true,update:true,delete:true},processFinancialSituation:{create:true,read:true,update:true,delete:true},processNature:{create:true,read:true,update:true,delete:true},processSituation:{create:true,read:true,update:true,delete:true},report:{read:true},schedule:{read:true,update:true},task:{create:true,read:true,update:true,delete:true},taskAutomation:{create:true,read:true,update:true,delete:true},user:{create:true,read:true,update:true,delete:true}};export var fetchInitalData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _getToken;var token,company_query,_response$,_response$2,_response$2$data,response,_response$0$data,success,key,company,trial,trial_rest_days,current_user,permissions,birthday,userName,kindUser;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:token=(_getToken=getToken())===null||_getToken===void 0?void 0:_getToken.token;// Pasando o token pq tem um delay até o axios setar o token, assim garante que sempre vai dar certo.\ncompany_query=api.get('/company',{headers:{authorization:\"Bearer \".concat(token)}});// const current_user_query =  api.get<CompanyRequestType>('/current_user', { headers: { authorization: `Bearer ${token}` } })\ndispatch({type:'SET_LOADING',payload:true});_context.prev=3;_context.next=6;return Promise.all([company_query]);case 6:response=_context.sent;_response$0$data=response[0].data,success=_response$0$data.success,key=_response$0$data.key;if(!(!success&&key==='activeCode')){_context.next=12;break;}dispatch({type:'SET_ACTIVE_ACCOUNT',payload:false});dispatch({type:'SET_LOADING',payload:false});return _context.abrupt(\"return\");case 12:company=(_response$=response[0])===null||_response$===void 0?void 0:_response$.data;trial=(_response$2=response[0])===null||_response$2===void 0?void 0:(_response$2$data=_response$2.data)===null||_response$2$data===void 0?void 0:_response$2$data.trial;_context.next=16;return fetchTrialDays(trial,token);case 16:trial_rest_days=_context.sent;_context.next=19;return fetchCurrentUser(token);case 19:current_user=_context.sent;permissions=(current_user===null||current_user===void 0?void 0:current_user.acecessPermission)||default_permissions;birthday=(current_user===null||current_user===void 0?void 0:current_user.birthday)||'';userName=(current_user===null||current_user===void 0?void 0:current_user.name)||'';kindUser=(current_user===null||current_user===void 0?void 0:current_user.kindUser)||{kindUser_id:'',kindUser_description:'',kindUser_key:''};dispatch({type:'SET_INITIAL_DATA',payload:{company:company,trial_rest_days:trial_rest_days,permissions:permissions,birthday:birthday,kindUser:kindUser,userName:userName}});_context.next=32;break;case 27:_context.prev=27;_context.t0=_context[\"catch\"](3);console.log(_context.t0);messageError('202010311855');dispatch({type:'SET_LOADING',payload:false});case 32:case\"end\":return _context.stop();}}},_callee,null,[[3,27]]);}));return function fetchInitalData(){return _ref.apply(this,arguments);};}();var fetchTrialDays=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(trial,token){var _yield$api$get,data,success,restDays;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(trial){_context2.next=2;break;}return _context2.abrupt(\"return\",0);case 2:_context2.prev=2;_context2.next=5;return api.get('/trial',{headers:{authorization:\"Bearer \".concat(token)}});case 5:_yield$api$get=_context2.sent;data=_yield$api$get.data;success=data.success,restDays=data.restDays;if(success){_context2.next=10;break;}return _context2.abrupt(\"return\",0);case 10:return _context2.abrupt(\"return\",restDays);case 13:_context2.prev=13;_context2.t0=_context2[\"catch\"](2);return _context2.abrupt(\"return\",0);case 16:case\"end\":return _context2.stop();}}},_callee2,null,[[2,13]]);}));return function fetchTrialDays(_x,_x2){return _ref2.apply(this,arguments);};}();var fetchCurrentUser=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(token){var _yield$api$get2,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return api.get('/currentuser',{headers:{authorization:\"Bearer \".concat(token)}});case 3:_yield$api$get2=_context3.sent;data=_yield$api$get2.data;return _context3.abrupt(\"return\",data);case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](0);return _context3.abrupt(\"return\",null);case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[0,8]]);}));return function fetchCurrentUser(_x3){return _ref3.apply(this,arguments);};}();export var userLogin=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(_ref4){var _response,_response3,_response4;var remember,user,response,success,_response2,token;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:remember=_ref4.remember,user=_objectWithoutProperties(_ref4,[\"remember\"]);response=null;dispatch({type:'SET_LOADING',payload:true});_context4.prev=3;_context4.next=6;return api.post('/session',_objectSpread({},user));case 6:response=_context4.sent;_context4.next=14;break;case 9:_context4.prev=9;_context4.t0=_context4[\"catch\"](3);messageError('202008151654');dispatch({type:'SET_LOADING',payload:false});return _context4.abrupt(\"return\");case 14:success=(_response=response)===null||_response===void 0?void 0:_response.data.success;if(!success){_context4.next=19;break;}token=((_response2=response)===null||_response2===void 0?void 0:_response2.data.token)||'';dispatch({type:'LOGIN',payload:{token:token,remember:remember}});return _context4.abrupt(\"return\",Promise.resolve());case 19:dispatch({type:'SET_LOADING',payload:false});return _context4.abrupt(\"return\",Promise.reject({key:(_response3=response)===null||_response3===void 0?void 0:_response3.data.key,message:(_response4=response)===null||_response4===void 0?void 0:_response4.data.message}));case 21:case\"end\":return _context4.stop();}}},_callee4,null,[[3,9]]);}));return function userLogin(_x4){return _ref5.apply(this,arguments);};}();export var updateCompanyData=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var _getToken2;var token,response,company;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:token=(_getToken2=getToken())===null||_getToken2===void 0?void 0:_getToken2.token;// Pasando o token pq tem um delay até o axios setar o token, assim garante que sempre vai dar certo.\n_context5.next=3;return api.get('/company',{headers:{authorization:\"Bearer \".concat(token)}});case 3:response=_context5.sent;company=response.data;dispatch({type:'UPDATE_COMPANY',payload:company});case 6:case\"end\":return _context5.stop();}}},_callee5);}));return function updateCompanyData(){return _ref6.apply(this,arguments);};}();","map":null,"metadata":{},"sourceType":"module"}