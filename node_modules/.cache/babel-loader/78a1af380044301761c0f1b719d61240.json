{"ast":null,"code":"var _jsxFileName = \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Pages/Document/Document.jsx\";\n\n(function () {\n  var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;\n  enterModule && enterModule(module);\n})();\n\nvar __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {\n  return a;\n};\n\nimport React, { useEffect, useState, useRef, useCallback } from 'react';\nimport { useNavigate, useParams } from 'react-router';\nimport { CKEditor } from '@ckeditor/ckeditor5-react';\nimport { Button, Col, Input, message, Row } from 'antd';\nimport { useUserSelector } from 'Redux/UserReducer';\nimport Editor from 'ckeditor5-custom-build/build/ckeditor';\nimport VariablesInput from './VariablesInput';\nimport styled from 'styled-components';\nimport useGetDocument from './useGetDocument';\nimport messageError from 'Utils/messageError';\nimport useSaveDocument from './useSaveDocument';\nimport successModal from 'Utils/successModal';\n\nconst Document = () => {\n  const permissions = useUserSelector(state => state.permissions);\n  const {\n    id\n  } = useParams();\n  const navigate = useNavigate();\n  const [getDocument, {\n    loading\n  }] = useGetDocument();\n  const [saveDocument, {\n    loading: save_loading\n  }] = useSaveDocument();\n  const [title, setTitle] = useState();\n  const editorRef = useRef(null);\n  const loadDocument = useCallback(async id => {\n    try {\n      const response = await getDocument(id);\n      const {\n        document\n      } = response === null || response === void 0 ? void 0 : response.data;\n      if (!editorRef.current) return;\n      setTitle(document.title);\n      editorRef.current.data.set(document.data);\n    } catch (error) {\n      messageError('202108222039');\n      console.error(error);\n    }\n  }, [getDocument]);\n  useEffect(() => {\n    if (!permissions.document.read) {\n      navigate('/');\n      return;\n    }\n\n    if (!id) return;\n    loadDocument(id); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [id]);\n\n  const addVariable = variable => {\n    if (!editorRef.current) {\n      message.error('Erro ao carregar o editor de texto. Recarregue a página e tente novamente. Se o error ' + 'persistir entre contato conosco. Código do erro: 2021221819');\n      return;\n    }\n\n    editorRef.current.model.change(writer => {\n      writer.insertText(`${variable} `, editorRef.current.model.document.selection.getFirstPosition());\n    });\n  };\n\n  const handleSaveDocument = async () => {\n    if (!title) {\n      message.info('Informe o título do documento!');\n      return;\n    }\n\n    const data = {\n      _id: id,\n      title: title,\n      data: editorRef.current.getData()\n    };\n    const response = await saveDocument(data);\n    const {\n      success\n    } = response.data;\n\n    if (success) {\n      successModal({\n        content: 'Documento salvo com sucesso'\n      });\n      setTimeout(() => navigate('/documents'), 1500);\n      return;\n    }\n\n    message.error(response.data.message);\n  };\n\n  const can_edit = !!id && permissions.document.update;\n  const can_create = !id && permissions.document.create;\n  return /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    gutter: 10,\n    style: {\n      width: '100%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    flex: \"400px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    value: title,\n    onChange: event => setTitle(event.target.value),\n    placeholder: \"T\\xEDtulo do Documento\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    flex: \"250px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(VariablesInput, {\n    type: \"people\",\n    addVariable: addVariable,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    flex: \"250px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(VariablesInput, {\n    type: \"process\",\n    addVariable: addVariable,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 13\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 9\n    }\n  }, (can_edit || can_create) && /*#__PURE__*/React.createElement(Button, {\n    type: \"primary\",\n    onClick: handleSaveDocument,\n    loading: loading || save_loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 13\n    }\n  }, \"Salvar\"))), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"document-editor__toolbar\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(EditorRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"editor-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(CKEditor, {\n    editor: Editor,\n    config: {\n      toolbar: ['undo', 'redo', 'pageBreak', 'horizontalLine', 'heading', '|', 'fontSize', 'fontFamily', 'fontColor', 'fontBackgroundColor', '|', 'bold', 'italic', 'underline', 'strikethrough', '|', 'numberedList', 'bulletedList', 'todoList', '|', 'outdent', 'indent', 'alignment', '|', 'link', 'insertTable', 'mediaEmbed', 'imageInsert', '|', 'highlight', 'findAndReplace'],\n      language: 'pt-br',\n      table: {\n        contentToolbar: ['tableColumn', 'tableRow', 'mergeTableCells', 'tableCellProperties', 'tableProperties']\n      },\n      licenseKey: ''\n    },\n    onReady: editor => {\n      // You can store the \"editor\" and use when it is needed.\n      editorRef.current = editor;\n      if (!permissions.document.read) return;\n      document.querySelector('.document-editor__toolbar').appendChild(editor.ui.view.toolbar.element);\n      document.querySelector('.ck-toolbar').classList.add('ck-reset_all');\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 11\n    }\n  }))));\n};\n\n__signature__(Document, \"useUserSelector{permissions}\\nuseParams{{ id }}\\nuseNavigate{navigate}\\nuseGetDocument{[getDocument, { loading }]}\\nuseSaveDocument{[saveDocument, { loading: save_loading }]}\\nuseState{[title, setTitle]}\\nuseRef{editorRef}\\nuseCallback{loadDocument}\\nuseEffect{}\", () => [useUserSelector, useParams, useNavigate, useGetDocument, useSaveDocument]);\n\nDocument.displayName = \"Document\";\nconst _default = Document;\nexport default _default;\nconst Container = styled.div.withConfig({\n  displayName: \"Document__Container\",\n  componentId: \"kcin10-0\"\n})([\"padding:20px;\"]);\nconst EditorRow = styled.div.withConfig({\n  displayName: \"Document__EditorRow\",\n  componentId: \"kcin10-1\"\n})([\"display:flex;justify-content:center;padding-top:20px;padding-bottom:20px;background:#f2f2f2;border:1px solid hsl(0,0%,77%);height:calc(100vh - 50px - 52px - 40px - 40px);overflow:auto;h1{font-weight:bold;}.editor-container{width:100%;max-width:700px;height:fit-content;background:white;border:1px hsl( 0,0%,82.7% ) solid;box-shadow:0 0 5px hsl(0deg 0% 0% / 10%);}.ck-editor__editable{min-height:700px;padding:40px !important;}\"]);\nconst Header = styled.div.withConfig({\n  displayName: \"Document__Header\",\n  componentId: \"kcin10-2\"\n})([\"display:flex;justify-content:space-between;margin-bottom:20px;\"]);\n;\n\n(function () {\n  var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(Document, \"Document\", \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Pages/Document/Document.jsx\");\n  reactHotLoader.register(Container, \"Container\", \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Pages/Document/Document.jsx\");\n  reactHotLoader.register(EditorRow, \"EditorRow\", \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Pages/Document/Document.jsx\");\n  reactHotLoader.register(Header, \"Header\", \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Pages/Document/Document.jsx\");\n  reactHotLoader.register(_default, \"default\", \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Pages/Document/Document.jsx\");\n})();\n\n;\n\n(function () {\n  var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;\n  leaveModule && leaveModule(module);\n})();","map":{"version":3,"sources":["/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Pages/Document/Document.jsx"],"names":["React","useEffect","useState","useRef","useCallback","useNavigate","useParams","CKEditor","Button","Col","Input","message","Row","useUserSelector","Editor","VariablesInput","styled","useGetDocument","messageError","useSaveDocument","successModal","Document","permissions","state","id","navigate","getDocument","loading","saveDocument","save_loading","title","setTitle","editorRef","loadDocument","response","document","data","current","set","error","console","read","addVariable","variable","model","change","writer","insertText","selection","getFirstPosition","handleSaveDocument","info","_id","getData","success","content","setTimeout","can_edit","update","can_create","create","width","event","target","value","toolbar","language","table","contentToolbar","licenseKey","editor","querySelector","appendChild","ui","view","element","classList","add","Container","div","EditorRow","Header"],"mappings":";;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,EAAqCC,MAArC,EAA6CC,WAA7C,QAAgE,OAAhE;AACA,SAASC,WAAT,EAAsBC,SAAtB,QAAuC,cAAvC;AACA,SAASC,QAAT,QAAyB,2BAAzB;AACA,SAASC,MAAT,EAAiBC,GAAjB,EAAsBC,KAAtB,EAA6BC,OAA7B,EAAsCC,GAAtC,QAAiD,MAAjD;AACA,SAASC,eAAT,QAAgC,mBAAhC;AACA,OAAOC,MAAP,MAAmB,uCAAnB;AACA,OAAOC,cAAP,MAA2B,kBAA3B;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AACA,OAAOC,cAAP,MAA2B,kBAA3B;AACA,OAAOC,YAAP,MAAyB,oBAAzB;AACA,OAAOC,eAAP,MAA4B,mBAA5B;AACA,OAAOC,YAAP,MAAyB,oBAAzB;;AAEA,MAAMC,QAAQ,GAAG,MAAM;AACrB,QAAMC,WAAW,GAAGT,eAAe,CAACU,KAAK,IAAIA,KAAK,CAACD,WAAhB,CAAnC;AAEA,QAAM;AAAEE,IAAAA;AAAF,MAASlB,SAAS,EAAxB;AACA,QAAMmB,QAAQ,GAAGpB,WAAW,EAA5B;AAEA,QAAM,CAACqB,WAAD,EAAc;AAAEC,IAAAA;AAAF,GAAd,IAA6BV,cAAc,EAAjD;AACA,QAAM,CAACW,YAAD,EAAe;AAAED,IAAAA,OAAO,EAAEE;AAAX,GAAf,IAA4CV,eAAe,EAAjE;AAEA,QAAM,CAACW,KAAD,EAAQC,QAAR,IAAoB7B,QAAQ,EAAlC;AACA,QAAM8B,SAAS,GAAG7B,MAAM,CAAC,IAAD,CAAxB;AAEA,QAAM8B,YAAY,GAAG7B,WAAW,CAAC,MAAOoB,EAAP,IAAc;AAC7C,QAAI;AACF,YAAMU,QAAQ,GAAG,MAAMR,WAAW,CAACF,EAAD,CAAlC;AAEA,YAAM;AAAEW,QAAAA;AAAF,UAAeD,QAAf,aAAeA,QAAf,uBAAeA,QAAQ,CAAEE,IAA/B;AAEA,UAAI,CAACJ,SAAS,CAACK,OAAf,EAAwB;AAExBN,MAAAA,QAAQ,CAACI,QAAQ,CAACL,KAAV,CAAR;AACAE,MAAAA,SAAS,CAACK,OAAV,CAAkBD,IAAlB,CAAuBE,GAAvB,CAA2BH,QAAQ,CAACC,IAApC;AACD,KATD,CASE,OAAOG,KAAP,EAAc;AACdrB,MAAAA,YAAY,CAAC,cAAD,CAAZ;AACAsB,MAAAA,OAAO,CAACD,KAAR,CAAcA,KAAd;AACD;AACF,GAd+B,EAc7B,CAACb,WAAD,CAd6B,CAAhC;AAgBAzB,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI,CAACqB,WAAW,CAACa,QAAZ,CAAqBM,IAA1B,EAAgC;AAC9BhB,MAAAA,QAAQ,CAAC,GAAD,CAAR;AACA;AACD;;AACD,QAAI,CAACD,EAAL,EAAS;AAETS,IAAAA,YAAY,CAACT,EAAD,CAAZ,CAPc,CAQhB;AACC,GATQ,EASN,CAACA,EAAD,CATM,CAAT;;AAWA,QAAMkB,WAAW,GAAIC,QAAD,IAAc;AAChC,QAAI,CAACX,SAAS,CAACK,OAAf,EAAwB;AACtB1B,MAAAA,OAAO,CAAC4B,KAAR,CAAc,2FACA,6DADd;AAEA;AACD;;AAEDP,IAAAA,SAAS,CAACK,OAAV,CAAkBO,KAAlB,CAAwBC,MAAxB,CAA+BC,MAAM,IAAI;AACvCA,MAAAA,MAAM,CAACC,UAAP,CAAmB,GAAEJ,QAAS,GAA9B,EAAkCX,SAAS,CAACK,OAAV,CAAkBO,KAAlB,CAAwBT,QAAxB,CAAiCa,SAAjC,CAA2CC,gBAA3C,EAAlC;AACD,KAFD;AAGD,GAVD;;AAYA,QAAMC,kBAAkB,GAAG,YAAY;AACrC,QAAI,CAACpB,KAAL,EAAY;AACVnB,MAAAA,OAAO,CAACwC,IAAR,CAAa,gCAAb;AACA;AACD;;AAED,UAAMf,IAAI,GAAG;AACXgB,MAAAA,GAAG,EAAE5B,EADM;AAEXM,MAAAA,KAAK,EAAEA,KAFI;AAGXM,MAAAA,IAAI,EAAEJ,SAAS,CAACK,OAAV,CAAkBgB,OAAlB;AAHK,KAAb;AAMA,UAAMnB,QAAQ,GAAG,MAAMN,YAAY,CAACQ,IAAD,CAAnC;AAEA,UAAM;AAAEkB,MAAAA;AAAF,QAAcpB,QAAQ,CAACE,IAA7B;;AAEA,QAAIkB,OAAJ,EAAa;AACXlC,MAAAA,YAAY,CAAC;AAAEmC,QAAAA,OAAO,EAAE;AAAX,OAAD,CAAZ;AACAC,MAAAA,UAAU,CAAC,MAAM/B,QAAQ,CAAC,YAAD,CAAf,EAA+B,IAA/B,CAAV;AACA;AACD;;AAEDd,IAAAA,OAAO,CAAC4B,KAAR,CAAcL,QAAQ,CAACE,IAAT,CAAczB,OAA5B;AACD,GAvBD;;AAyBA,QAAM8C,QAAQ,GAAG,CAAC,CAACjC,EAAF,IAAQF,WAAW,CAACa,QAAZ,CAAqBuB,MAA9C;AACA,QAAMC,UAAU,GAAG,CAACnC,EAAD,IAAOF,WAAW,CAACa,QAAZ,CAAqByB,MAA/C;AAEA,sBACE,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,GAAD;AAAK,IAAA,MAAM,EAAE,EAAb;AAAiB,IAAA,KAAK,EAAE;AAAEC,MAAAA,KAAK,EAAE;AAAT,KAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,GAAD;AAAK,IAAA,IAAI,EAAC,OAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,KAAD;AACE,IAAA,KAAK,EAAE/B,KADT;AAEE,IAAA,QAAQ,EAAGgC,KAAD,IAAW/B,QAAQ,CAAC+B,KAAK,CAACC,MAAN,CAAaC,KAAd,CAF/B;AAGE,IAAA,WAAW,EAAC,wBAHd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CADF,eASE,oBAAC,GAAD;AAAK,IAAA,IAAI,EAAC,OAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,cAAD;AAAgB,IAAA,IAAI,EAAC,QAArB;AAA8B,IAAA,WAAW,EAAEtB,WAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CATF,eAaE,oBAAC,GAAD;AAAK,IAAA,IAAI,EAAC,OAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,cAAD;AAAgB,IAAA,IAAI,EAAC,SAArB;AAA+B,IAAA,WAAW,EAAEA,WAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAbF,CADF,eAmBE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG,CAACe,QAAQ,IAAIE,UAAb,kBACC,oBAAC,MAAD;AAAQ,IAAA,IAAI,EAAC,SAAb;AAAuB,IAAA,OAAO,EAAET,kBAAhC;AAAoD,IAAA,OAAO,EAAEvB,OAAO,IAAIE,YAAxE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAFJ,CAnBF,CADF,eA6BE;AAAK,IAAA,KAAK,EAAC,0BAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IA7BF,eA+BE,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAC,kBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,QAAD;AACI,IAAA,MAAM,EAAEf,MADZ;AAEI,IAAA,MAAM,EAAE;AACNmD,MAAAA,OAAO,EAAE,CACP,MADO,EAEP,MAFO,EAGP,WAHO,EAIP,gBAJO,EAKP,SALO,EAMP,GANO,EAOP,UAPO,EAQP,YARO,EASP,WATO,EAUP,qBAVO,EAWP,GAXO,EAYP,MAZO,EAaP,QAbO,EAcP,WAdO,EAeP,eAfO,EAgBP,GAhBO,EAiBP,cAjBO,EAkBP,cAlBO,EAmBP,UAnBO,EAoBP,GApBO,EAqBP,SArBO,EAsBP,QAtBO,EAuBP,WAvBO,EAwBP,GAxBO,EAyBP,MAzBO,EA0BP,aA1BO,EA2BP,YA3BO,EA4BP,aA5BO,EA6BP,GA7BO,EA8BP,WA9BO,EA+BP,gBA/BO,CADH;AAmCNC,MAAAA,QAAQ,EAAE,OAnCJ;AAqCNC,MAAAA,KAAK,EAAE;AACLC,QAAAA,cAAc,EAAE,CACd,aADc,EAEd,UAFc,EAGd,iBAHc,EAId,qBAJc,EAKd,iBALc;AADX,OArCD;AA+CNC,MAAAA,UAAU,EAAE;AA/CN,KAFZ;AAmDI,IAAA,OAAO,EAAEC,MAAM,IAAI;AACjB;AACAtC,MAAAA,SAAS,CAACK,OAAV,GAAoBiC,MAApB;AACA,UAAI,CAAChD,WAAW,CAACa,QAAZ,CAAqBM,IAA1B,EAAgC;AAEhCN,MAAAA,QAAQ,CAACoC,aAAT,CAAuB,2BAAvB,EAAoDC,WAApD,CAAgEF,MAAM,CAACG,EAAP,CAAUC,IAAV,CAAeT,OAAf,CAAuBU,OAAvF;AACAxC,MAAAA,QAAQ,CAACoC,aAAT,CAAuB,aAAvB,EAAsCK,SAAtC,CAAgDC,GAAhD,CAAoD,cAApD;AACD,KA1DL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CADF,CA/BF,CADF;AAkGD,CAjLD;;cAAMxD,Q,mRACgBR,e,EAELP,S,EACED,W,EAEkBY,c,EACeE,e;;AAP9CE,Q;iBAmLSA,Q;AAAf;AAEA,MAAMyD,SAAS,GAAG9D,MAAM,CAAC+D,GAAV;AAAA;AAAA;AAAA,qBAAf;AAIA,MAAMC,SAAS,GAAGhE,MAAM,CAAC+D,GAAV;AAAA;AAAA;AAAA,kbAAf;AA8BA,MAAME,MAAM,GAAGjE,MAAM,CAAC+D,GAAV;AAAA;AAAA;AAAA,sEAAZ;;;;;;;;;;0BAvNM1D,Q;0BAqLAyD,S;0BAIAE,S;0BA8BAC,M","sourcesContent":["import React, { useEffect, useState, useRef, useCallback } from 'react'\nimport { useNavigate, useParams } from 'react-router'\nimport { CKEditor } from '@ckeditor/ckeditor5-react'\nimport { Button, Col, Input, message, Row } from 'antd'\nimport { useUserSelector } from 'Redux/UserReducer'\nimport Editor from 'ckeditor5-custom-build/build/ckeditor'\nimport VariablesInput from './VariablesInput'\nimport styled from 'styled-components'\nimport useGetDocument from './useGetDocument'\nimport messageError from 'Utils/messageError'\nimport useSaveDocument from './useSaveDocument'\nimport successModal from 'Utils/successModal'\n\nconst Document = () => {\n  const permissions = useUserSelector(state => state.permissions)\n\n  const { id } = useParams()\n  const navigate = useNavigate()\n\n  const [getDocument, { loading }] = useGetDocument()\n  const [saveDocument, { loading: save_loading }] = useSaveDocument()\n\n  const [title, setTitle] = useState()\n  const editorRef = useRef(null)\n\n  const loadDocument = useCallback(async (id) => {\n    try {\n      const response = await getDocument(id)\n\n      const { document } = response?.data\n\n      if (!editorRef.current) return\n\n      setTitle(document.title)\n      editorRef.current.data.set(document.data)\n    } catch (error) {\n      messageError('202108222039')\n      console.error(error)\n    }\n  }, [getDocument])\n\n  useEffect(() => {\n    if (!permissions.document.read) {\n      navigate('/')\n      return\n    }\n    if (!id) return\n\n    loadDocument(id)\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [id])\n\n  const addVariable = (variable) => {\n    if (!editorRef.current) {\n      message.error('Erro ao carregar o editor de texto. Recarregue a página e tente novamente. Se o error ' +\n                    'persistir entre contato conosco. Código do erro: 2021221819')\n      return\n    }\n\n    editorRef.current.model.change(writer => {\n      writer.insertText(`${variable} `, editorRef.current.model.document.selection.getFirstPosition())\n    })\n  }\n\n  const handleSaveDocument = async () => {\n    if (!title) {\n      message.info('Informe o título do documento!')\n      return\n    }\n\n    const data = {\n      _id: id,\n      title: title,\n      data: editorRef.current.getData()\n    }\n\n    const response = await saveDocument(data)\n\n    const { success } = response.data\n\n    if (success) {\n      successModal({ content: 'Documento salvo com sucesso' })\n      setTimeout(() => navigate('/documents'), 1500)\n      return\n    }\n\n    message.error(response.data.message)\n  }\n\n  const can_edit = !!id && permissions.document.update\n  const can_create = !id && permissions.document.create\n\n  return (\n    <Container>\n      <Header>\n        <Row gutter={10} style={{ width: '100%' }}>\n          <Col flex=\"400px\">\n            <Input\n              value={title}\n              onChange={(event) => setTitle(event.target.value)}\n              placeholder=\"Título do Documento\"\n            />\n          </Col>\n\n          <Col flex=\"250px\">\n            <VariablesInput type=\"people\" addVariable={addVariable} />\n          </Col>\n\n          <Col flex=\"250px\">\n            <VariablesInput type=\"process\" addVariable={addVariable} />\n          </Col>\n        </Row>\n\n        <div>\n          {(can_edit || can_create) && (\n            <Button type=\"primary\" onClick={handleSaveDocument} loading={loading || save_loading}>\n              Salvar\n            </Button>\n          )}\n        </div>\n      </Header>\n\n      <div class=\"document-editor__toolbar\" />\n\n      <EditorRow>\n        <div className=\"editor-container\">\n          <CKEditor\n              editor={Editor}\n              config={{\n                toolbar: [\n                  'undo',\n                  'redo',\n                  'pageBreak',\n                  'horizontalLine',\n                  'heading',\n                  '|',\n                  'fontSize',\n                  'fontFamily',\n                  'fontColor',\n                  'fontBackgroundColor',\n                  '|',\n                  'bold',\n                  'italic',\n                  'underline',\n                  'strikethrough',\n                  '|',\n                  'numberedList',\n                  'bulletedList',\n                  'todoList',\n                  '|',\n                  'outdent',\n                  'indent',\n                  'alignment',\n                  '|',\n                  'link',\n                  'insertTable',\n                  'mediaEmbed',\n                  'imageInsert',\n                  '|',\n                  'highlight',\n                  'findAndReplace'\n                ],\n\n                language: 'pt-br',\n\n                table: {\n                  contentToolbar: [\n                    'tableColumn',\n                    'tableRow',\n                    'mergeTableCells',\n                    'tableCellProperties',\n                    'tableProperties'\n                  ]\n                },\n\n                licenseKey: '',\n              }}\n              onReady={editor => {\n                // You can store the \"editor\" and use when it is needed.\n                editorRef.current = editor\n                if (!permissions.document.read) return\n\n                document.querySelector('.document-editor__toolbar').appendChild(editor.ui.view.toolbar.element)\n                document.querySelector('.ck-toolbar').classList.add('ck-reset_all')\n              }}\n          />\n        </div>\n      </EditorRow>\n    </Container>\n  )\n}\n\nexport default Document\n\nconst Container = styled.div`\n  padding: 20px;\n`\n\nconst EditorRow = styled.div`\n  display: flex;\n  justify-content: center;\n  padding-top: 20px;\n  padding-bottom: 20px;\n  background: #f2f2f2;\n  border: 1px solid hsl(0, 0%, 77%);\n  /* 50 do menu principal, 52 do header da pagina, 40 do padding da página, 40 da toolbar */\n  height: calc(100vh - 50px - 52px - 40px - 40px);\n  overflow: auto;\n\n  h1 {\n    font-weight: bold;\n  }\n\n  .editor-container {\n    width: 100%;\n    max-width: 700px;\n    height: fit-content;\n    background: white;\n    border: 1px hsl( 0, 0%, 82.7% ) solid;\n    box-shadow: 0 0 5px hsl(0deg 0% 0% / 10%);\n  }\n\n  .ck-editor__editable {\n    min-height: 700px;\n    padding: 40px !important;\n  }\n`\n\nconst Header = styled.div`\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 20px;\n`\n"]},"metadata":{},"sourceType":"module"}