{"ast":null,"code":"var _jsxFileName = \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Pages/NewUser/NewUser.tsx\";\n\n(function () {\n  var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;\n  enterModule && enterModule(module);\n})();\n\nvar __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {\n  return a;\n};\n\nimport React, { useEffect, useRef } from 'react';\nimport { Form, Row, Col, Space, Button, message } from 'antd';\nimport { useNavigate, useParams } from 'react-router';\nimport AditionalUserModal from './AditionalUserModal';\nimport UserForm from './UserForm';\nimport PermissionsForm from './PermissionsForm';\nimport styled from 'styled-components';\nimport moment from 'moment';\nimport messageError from 'Utils/messageError';\nimport successModal from 'Utils/successModal';\nimport useSaveUser from './useSaveUser';\nimport useGetUser from './useGetUser';\nimport { useUserSelector } from 'Redux/UserReducer';\nimport PermissionsContainer from 'Components/Permissions/Container';\n\nconst NewUser = () => {\n  const permissions = useUserSelector(state => state.permissions);\n  const kindUser = useUserSelector(state => state.kindUser);\n  const aditionalUserModalRef = useRef(null);\n  const {\n    id\n  } = useParams();\n  const navigate = useNavigate();\n  const [form] = Form.useForm();\n  const [saveUser, {\n    loading\n  }] = useSaveUser();\n  const [getUser, {\n    loading: user_loading\n  }] = useGetUser();\n  const DATE_FIELDS = ['birthday', 'createAt']; // Se não tem permissão para ver tbm não pode acessar, verificação feita no routes.ts\n\n  const has_permission = !!id && (permissions === null || permissions === void 0 ? void 0 : permissions.user.update) || !id && (permissions === null || permissions === void 0 ? void 0 : permissions.user.create);\n\n  const loadUser = async user_id => {\n    try {\n      var _data$kindUser, _data$professional;\n\n      const {\n        data\n      } = await getUser(user_id);\n      Object.entries(data).forEach(([key, value]) => {\n        if (DATE_FIELDS.includes(key) && value) {\n          // @ts-ignore\n          data[key] = moment(value, 'YYYY-MM-DD');\n        }\n      });\n      const user_values = { ...data,\n        kindUser_id: (_data$kindUser = data.kindUser) === null || _data$kindUser === void 0 ? void 0 : _data$kindUser.kindUser_id,\n        professional_id: (_data$professional = data.professional) === null || _data$professional === void 0 ? void 0 : _data$professional.professional_id\n      };\n      form.setFieldsValue(user_values);\n    } catch (error) {\n      messageError('202010311510');\n      console.log(error);\n    }\n  };\n\n  useEffect(() => {\n    if (id && has_permission) loadUser(id); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [id]);\n\n  const addAditionalUser = async () => {\n    try {\n      var _aditionalUserModalRe;\n\n      (_aditionalUserModalRe = aditionalUserModalRef.current) === null || _aditionalUserModalRe === void 0 ? void 0 : _aditionalUserModalRe.close();\n      const values = await form.validateFields();\n      handleFormFinish({ ...values,\n        additionalUser: true\n      });\n    } catch (error) {\n      console.log('[NewUser] ', error);\n    }\n  };\n\n  const normalizeValues = values => {\n    Object.entries(values).forEach(([key, value]) => {\n      if (DATE_FIELDS.includes(key) && value) {\n        values[key] = value.format('YYYY-MM-DD');\n      }\n    });\n    return values;\n  };\n\n  const handleFormFinish = async raw_values => {\n    const values = normalizeValues(raw_values);\n\n    try {\n      const response = await saveUser(values);\n\n      if (response.data.success) {\n        successModal({\n          content: 'Usuário salvo com sucesso'\n        });\n        setTimeout(() => {\n          navigate('/users');\n        }, 1500);\n        return;\n      }\n\n      message.error(response.data.message);\n    } catch (error) {\n      console.log('[NewUser] ', error.response);\n      const {\n        key\n      } = error.response.data;\n\n      if (key === 'aditional_user') {\n        var _aditionalUserModalRe2;\n\n        (_aditionalUserModalRe2 = aditionalUserModalRef.current) === null || _aditionalUserModalRe2 === void 0 ? void 0 : _aditionalUserModalRe2.open();\n        return;\n      }\n\n      messageError('2020102046');\n      console.log('[NewUser] ', error);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(PermissionsContainer, {\n    has_permission: has_permission,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Form, {\n    form: form,\n    layout: \"vertical\",\n    style: {\n      width: '100%'\n    },\n    onFinish: handleFormFinish,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 9\n    }\n  }, (kindUser === null || kindUser === void 0 ? void 0 : kindUser.kindUser_key) === 'admin' ? /*#__PURE__*/React.createElement(Row, {\n    gutter: 40,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    span: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(UserForm, {\n    id: id,\n    isAdmin: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 19\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    span: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(PermissionsForm, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 19\n    }\n  }))) : /*#__PURE__*/React.createElement(UserForm, {\n    id: id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Footer, {\n    justify: \"end\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Space, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    onClick: () => navigate('/users'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 15\n    }\n  }, \"Cancelar\"), /*#__PURE__*/React.createElement(Button, {\n    disabled: loading || user_loading,\n    loading: loading || user_loading,\n    type: \"primary\",\n    htmlType: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 15\n    }\n  }, \"Salvar\")))), /*#__PURE__*/React.createElement(AditionalUserModal, {\n    onAccept: addAditionalUser,\n    ref: aditionalUserModalRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 9\n    }\n  })));\n};\n\n__signature__(NewUser, \"useUserSelector{permissions}\\nuseUserSelector{kindUser}\\nuseRef{aditionalUserModalRef}\\nuseParams{{ id }}\\nuseNavigate{navigate}\\nuseForm{[form]}\\nuseSaveUser{[saveUser, { loading }]}\\nuseGetUser{[getUser, { loading: user_loading }]}\\nuseEffect{}\", () => [useUserSelector, useUserSelector, useParams, useNavigate, useSaveUser, useGetUser]);\n\nNewUser.displayName = \"NewUser\";\nconst _default = NewUser;\nexport default _default;\nconst Container = styled(Row).withConfig({\n  displayName: \"NewUser__Container\",\n  componentId: \"sc-1yg33zf-0\"\n})([\"overflow-y:auto;overflow-x:hidden;padding:20px 40px 0 40px;height:calc(100% - 5rem);\"]);\nconst Footer = styled(Row).withConfig({\n  displayName: \"NewUser__Footer\",\n  componentId: \"sc-1yg33zf-1\"\n})([\"width:100%;position:sticky;bottom:43px;background:white;padding:8px 0;\"]);\n;\n\n(function () {\n  var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(NewUser, \"NewUser\", \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Pages/NewUser/NewUser.tsx\");\n  reactHotLoader.register(Container, \"Container\", \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Pages/NewUser/NewUser.tsx\");\n  reactHotLoader.register(Footer, \"Footer\", \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Pages/NewUser/NewUser.tsx\");\n  reactHotLoader.register(_default, \"default\", \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Pages/NewUser/NewUser.tsx\");\n})();\n\n;\n\n(function () {\n  var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;\n  leaveModule && leaveModule(module);\n})();","map":{"version":3,"sources":["/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Pages/NewUser/NewUser.tsx"],"names":["React","useEffect","useRef","Form","Row","Col","Space","Button","message","useNavigate","useParams","AditionalUserModal","UserForm","PermissionsForm","styled","moment","messageError","successModal","useSaveUser","useGetUser","useUserSelector","PermissionsContainer","NewUser","permissions","state","kindUser","aditionalUserModalRef","id","navigate","form","useForm","saveUser","loading","getUser","user_loading","DATE_FIELDS","has_permission","user","update","create","loadUser","user_id","data","Object","entries","forEach","key","value","includes","user_values","kindUser_id","professional_id","professional","setFieldsValue","error","console","log","addAditionalUser","current","close","values","validateFields","handleFormFinish","additionalUser","normalizeValues","format","raw_values","response","success","content","setTimeout","open","width","kindUser_key","Container","Footer"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState } from 'react'\nimport { Form, Row, Col, Space, Button, message } from 'antd'\nimport { useNavigate, useParams } from 'react-router'\nimport { Store } from 'antd/lib/form/interface'\nimport AditionalUserModal, { AditionalUserModalRefType } from './AditionalUserModal'\nimport UserForm from './UserForm'\nimport PermissionsForm from './PermissionsForm'\nimport styled from 'styled-components'\nimport moment from 'moment'\nimport messageError from 'Utils/messageError'\nimport successModal from 'Utils/successModal'\nimport useSaveUser from './useSaveUser'\nimport useGetUser from './useGetUser'\nimport { useUserSelector } from 'Redux/UserReducer'\nimport PermissionsContainer from 'Components/Permissions/Container'\n\nconst NewUser: React.FC = () => {\n  const permissions = useUserSelector(state => state.permissions)\n  const kindUser = useUserSelector(state => state.kindUser)\n\n  const aditionalUserModalRef = useRef<AditionalUserModalRefType>(null)\n  const { id } = useParams()\n  const navigate = useNavigate()\n  const [form] = Form.useForm()\n  const [saveUser, { loading }] = useSaveUser()\n  const [getUser, { loading: user_loading }] = useGetUser()\n\n  const DATE_FIELDS = [\n    'birthday',\n    'createAt'\n  ]\n\n  // Se não tem permissão para ver tbm não pode acessar, verificação feita no routes.ts\n  const has_permission = (!!id && permissions?.user.update) || (!id && permissions?.user.create)\n\n  const loadUser = async (user_id: string) => {\n    try {\n      const { data }  = await getUser(user_id)\n\n      Object.entries(data).forEach(([key, value]) => {\n        if (DATE_FIELDS.includes(key) && value) {\n          // @ts-ignore\n          data[key] = moment(value, 'YYYY-MM-DD')\n        }\n      })\n\n      const user_values = {\n        ...data,\n        kindUser_id: data.kindUser?.kindUser_id,\n        professional_id: data.professional?.professional_id\n      }\n      form.setFieldsValue(user_values)\n    } catch (error) {\n      messageError('202010311510')\n      console.log(error)\n    }\n  }\n\n  useEffect(() => {\n    if (id && has_permission) loadUser(id)\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [id])\n\n  const addAditionalUser = async () => {\n    try {\n      aditionalUserModalRef.current?.close()\n      const values = await form.validateFields()\n      handleFormFinish({ ...values, additionalUser: true })\n    } catch (error) {\n      console.log('[NewUser] ', error)\n    }\n  }\n\n  const normalizeValues = (values: Store) => {\n    Object.entries(values).forEach(([key, value]) => {\n      if (DATE_FIELDS.includes(key) && value) {\n        values[key] = value.format('YYYY-MM-DD')\n      }\n    })\n\n    return values\n  }\n\n  const handleFormFinish = async (raw_values: Store) => {\n    const values = normalizeValues(raw_values)\n\n    try {\n      const response = await saveUser(values as any)\n\n      if (response.data.success) {\n        successModal({ content: 'Usuário salvo com sucesso' })\n        setTimeout(() => {\n          navigate('/users')\n        }, 1500)\n        return\n      }\n\n      message.error(response.data.message)\n    } catch (error) {\n      console.log('[NewUser] ', error.response)\n      const { key } = error.response.data\n      if (key === 'aditional_user') {\n        aditionalUserModalRef.current?.open()\n        return\n      }\n\n      messageError('2020102046')\n      console.log('[NewUser] ', error)\n    }\n  }\n\n  return (\n    <PermissionsContainer has_permission={has_permission}>\n      <Container>\n        <Form form={form} layout=\"vertical\" style={{ width: '100%' }} onFinish={handleFormFinish}>\n\n          {kindUser?.kindUser_key === 'admin'  ? (\n            <Row gutter={40}>\n                <Col span={12}>\n                  <UserForm id={id} isAdmin={true}/>\n                </Col>\n                <Col span={12}>\n                  <PermissionsForm/>\n                </Col>\n            </Row>\n          ) : (\n            <UserForm id={id}/>\n          )}\n          <Footer justify=\"end\">\n            <Space>\n              <Button onClick={() => navigate('/users')}>Cancelar</Button>\n              <Button\n                disabled={loading || user_loading}\n                loading={loading || user_loading}\n                type=\"primary\"\n                htmlType=\"submit\"\n              >\n                Salvar\n              </Button>\n            </Space>\n          </Footer>\n        </Form>\n        <AditionalUserModal onAccept={addAditionalUser} ref={aditionalUserModalRef}/>\n      </Container>\n    </PermissionsContainer>\n  )\n}\n\nexport default NewUser\n\nconst Container = styled(Row)`\n  overflow-y: auto;\n  overflow-x: hidden;\n  padding: 20px 40px 0 40px;\n  height: calc(100% - 5rem);\n`\n\nconst Footer = styled(Row)`\n  width: 100%;\n  position: sticky;\n  bottom: 43px;\n  background: white;\n  padding: 8px 0;\n`\n"]},"metadata":{},"sourceType":"module"}