{"ast":null,"code":"var _jsxFileName = \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Pages/History/History.tsx\";\n\n(function () {\n  var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;\n  enterModule && enterModule(module);\n})();\n\nvar __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {\n  return a;\n};\n\nimport React, { useState, memo, useMemo, useCallback, useEffect, useRef } from 'react';\nimport { uniqBy } from 'lodash';\nimport ContainerList from 'Components/MainList/ContainerList';\nimport HistoryTable from './HistoryTable';\nimport useGetHistories from './useGetHistories';\nimport Header from './Header';\nimport TableContainer from '../../Components/MainList/TableContainer';\n\nconst History = () => {\n  const [filters, setFilters] = useState({\n    dates: [],\n    user_id: null,\n    action_id: null,\n    module_id: null\n  });\n  const [{\n    loading,\n    data\n  }, fetchHistories] = useGetHistories();\n  useEffect(() => {\n    fetchHistories(); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  const handleChangeFilters = useCallback((type, value) => {\n    const new_filters = { ...filters,\n      [type]: value\n    };\n    setFilters(new_filters);\n  }, [filters]);\n  const histories = data || [];\n  const filteredHistories = useCallback(() => {\n    return histories.filter(history => {\n      if (filters.dates[0] && (!history.createAt || history.createAt < filters.dates[0])) return false;\n      if (filters.dates[1] && (!history.createAt || history.createAt > filters.dates[1])) return false;\n      if (filters.user_id && history.user.user_id !== filters.user_id) return false;\n      if (filters.action_id && history.action.action_id !== filters.action_id) return false;\n      if (filters.module_id && history.module.module_id !== filters.module_id) return false;\n      return true;\n    });\n  }, [filters.action_id, filters.dates, filters.module_id, filters.user_id, histories]);\n  const modules = useMemo(() => histories.map(history => history.module), [histories]);\n  const non_duplicated_modules = useMemo(() => uniqBy(modules, 'module_id').filter(module => module.module_id), [modules]);\n  const actions = histories.map(history => history.action);\n  const non_duplicated_actions = useMemo(() => uniqBy(actions, 'action_id').filter(action => action.action_id), [actions]);\n  const divRef = useRef(null);\n  return /*#__PURE__*/React.createElement(ContainerList, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Header, {\n    handleChangeFilters: handleChangeFilters,\n    modules: non_duplicated_modules,\n    actions: non_duplicated_actions,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(TableContainer, {\n    divRef: divRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(HistoryTable, {\n    data: filteredHistories(),\n    loading: loading,\n    divRef: divRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 9\n    }\n  })));\n};\n\n__signature__(History, \"useState{[filters, setFilters]({ dates: [], user_id: null, action_id: null, module_id: null })}\\nuseGetHistories{[{ loading, data }, fetchHistories]}\\nuseEffect{}\\nuseCallback{handleChangeFilters}\\nuseCallback{filteredHistories}\\nuseMemo{modules}\\nuseMemo{non_duplicated_modules}\\nuseMemo{non_duplicated_actions}\\nuseRef{divRef}\", () => [useGetHistories]);\n\nHistory.displayName = \"History\";\n\nconst _default = memo(History);\n\nexport default _default;\n;\n\n(function () {\n  var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(History, \"History\", \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Pages/History/History.tsx\");\n  reactHotLoader.register(_default, \"default\", \"/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Pages/History/History.tsx\");\n})();\n\n;\n\n(function () {\n  var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;\n  leaveModule && leaveModule(module);\n})();","map":{"version":3,"sources":["/Users/raphael/Documents/Github/FrontSistemadoPerito/src/Pages/History/History.tsx"],"names":["React","useState","memo","useMemo","useCallback","useEffect","useRef","uniqBy","ContainerList","HistoryTable","useGetHistories","Header","TableContainer","History","filters","setFilters","dates","user_id","action_id","module_id","loading","data","fetchHistories","handleChangeFilters","type","value","new_filters","histories","filteredHistories","filter","history","createAt","user","action","module","modules","map","non_duplicated_modules","actions","non_duplicated_actions","divRef"],"mappings":"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","sourcesContent":["import React, { useState, memo, useMemo, useCallback, useEffect, useRef } from 'react'\nimport { uniqBy } from 'lodash'\nimport { ChangedFiltersType } from './types'\nimport ContainerList from 'Components/MainList/ContainerList'\nimport HistoryTable from './HistoryTable'\nimport useGetHistories from './useGetHistories'\nimport Header from './Header'\nimport TableContainer from '../../Components/MainList/TableContainer'\n\ntype FiltersType = {\n  dates: string[],\n  user_id: string | null,\n  action_id: string | null,\n  module_id: string | null,\n}\n\nconst History: React.FC = () => {\n  const [filters, setFilters] = useState<FiltersType>({ dates: [], user_id: null, action_id: null, module_id: null })\n  const [{ loading, data }, fetchHistories] = useGetHistories()\n\n  useEffect(() => {\n    fetchHistories()\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  const handleChangeFilters = useCallback((type: ChangedFiltersType, value: string | (string | undefined)[]) => {\n    const new_filters = { ...filters, [type]: value }\n\n    setFilters(new_filters)\n  }, [filters])\n\n  const histories = data || []\n\n  const filteredHistories = useCallback(() => {\n    return histories.filter(history => {\n      if (filters.dates[0] && (!history.createAt || history.createAt < filters.dates[0])) return false\n      if (filters.dates[1] && (!history.createAt || history.createAt > filters.dates[1])) return false\n      if (filters.user_id && history.user.user_id !== filters.user_id) return false\n      if (filters.action_id && history.action.action_id !== filters.action_id) return false\n      if (filters.module_id && history.module.module_id !== filters.module_id) return false\n\n      return true\n    })\n  }, [filters.action_id, filters.dates, filters.module_id, filters.user_id, histories])\n\n  const modules = useMemo(() => histories.map(history => history.module), [histories])\n  const non_duplicated_modules = useMemo(() => uniqBy(modules, 'module_id').filter(module => module.module_id), [modules])\n\n  const actions = histories.map(history => history.action)\n  const non_duplicated_actions = useMemo(() => uniqBy(actions, 'action_id').filter(action => action.action_id), [actions])\n\n  const divRef = useRef<HTMLDivElement>(null)\n\n  return (\n    <ContainerList>\n      <Header\n        handleChangeFilters={handleChangeFilters}\n        modules={non_duplicated_modules}\n        actions={non_duplicated_actions}\n      />\n\n      <TableContainer divRef={divRef}>\n        <HistoryTable\n          data={filteredHistories()}\n          loading={loading}\n          divRef={divRef}\n        />\n      </TableContainer>\n    </ContainerList>\n  )\n}\n\nexport default memo(History)\n"]},"metadata":{},"sourceType":"module"}