{"ast":null,"code":"import _regeneratorRuntime from\"/Users/raphael/Documents/Github/FrontSistemadoPerito/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/raphael/Documents/Github/FrontSistemadoPerito/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/raphael/Documents/Github/FrontSistemadoPerito/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/raphael/Documents/Github/FrontSistemadoPerito/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useRef,useState}from'react';import{buildData,MONTHLY_PRICE,YEARLY_PRICE}from'./functions';import{message,Spin,Switch,Table}from'antd';import{useUserDispatch,useUserSelector}from'Redux/UserReducer';import PaymentMethodModal from'Components/Modals/PaymentMethod/PaymentMethodModal';import messageError from'Utils/messageError';import useGetPlans from'./useGetPlans';import styled from'styled-components';import useColumns from'./useColumns';import useSaveCompany from'Pages/Company/useSaveCompany';import successModal from'Utils/successModal';import{useNavigate}from'react-router-dom';var Plans=function Plans(){var _company$plan;var company=useUserSelector(function(state){return state.company;});var annual=!!(company===null||company===void 0?void 0:(_company$plan=company.plan)===null||_company$plan===void 0?void 0:_company$plan.annual);var _useState=useState(annual),_useState2=_slicedToArray(_useState,2),internal_yearly=_useState2[0],setInternalYearly=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),plans=_useState4[0],setPlans=_useState4[1];var _useSaveCompany=useSaveCompany(),_useSaveCompany2=_slicedToArray(_useSaveCompany,2),saveCompany=_useSaveCompany2[0],saving=_useSaveCompany2[1].loading;var _useGetPlans=useGetPlans(),_useGetPlans2=_slicedToArray(_useGetPlans,2),loading=_useGetPlans2[0].loading,getPlans=_useGetPlans2[1];var PaymentMethodRef=useRef(null);var dispatch=useUserDispatch();var navigate=useNavigate();var handleSaveCompany=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(plan_id){var values,_yield$saveCompany,_data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;values=_objectSpread({},company,{plan_id:plan_id,annual:internal_yearly});_context.next=4;return saveCompany(values);case 4:_yield$saveCompany=_context.sent;_data=_yield$saveCompany.data;if(_data===null||_data===void 0?void 0:_data.success){_context.next=9;break;}message.error(_data.message);return _context.abrupt(\"return\");case 9:dispatch({type:'UPDATE_COMPANY',payload:_data.company});successModal({content:'Plano escolhido com sucesso',duration:4000,onEndDuration:function onEndDuration(){return navigate('/');}});_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);messageError('2011142222');case 16:case\"end\":return _context.stop();}}},_callee,null,[[0,13]]);}));return function handleSaveCompany(_x){return _ref.apply(this,arguments);};}();var handleClickPlan=function handleClickPlan(plan_name){var plan=plans.find(function(plan){return plan.name===plan_name;});if(!(company===null||company===void 0?void 0:company.toHire)){var _PaymentMethodRef$cur;(_PaymentMethodRef$cur=PaymentMethodRef.current)===null||_PaymentMethodRef$cur===void 0?void 0:_PaymentMethodRef$cur.open({plan:{_id:plan._id,annual:internal_yearly}});return;}handleSaveCompany(plan._id);};var fetchPlans=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _yield$getPlans,_data2;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return getPlans();case 3:_yield$getPlans=_context2.sent;_data2=_yield$getPlans.data;if(_data2.success){_context2.next=8;break;}message.error(_data2.message);return _context2.abrupt(\"return\");case 8:setPlans(_data2.plans);_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](0);messageError('2011051928');case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[0,11]]);}));return function fetchPlans(){return _ref2.apply(this,arguments);};}();useEffect(function(){fetchPlans();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);var data=buildData({prices:internal_yearly?YEARLY_PRICE:MONTHLY_PRICE});var columns=useColumns({yearly:internal_yearly,handleClickPlan:handleClickPlan});return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Spin,{spinning:loading||saving},/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(Header,null,/*#__PURE__*/React.createElement(Text,null,\"Mensal\"),/*#__PURE__*/React.createElement(SwitchStyled,{onChange:function onChange(value){return setInternalYearly(value);},checked:internal_yearly}),/*#__PURE__*/React.createElement(Text,null,\"Anual\")),/*#__PURE__*/React.createElement(StyledTable,{dataSource:data,columns:columns,pagination:{pageSize:20,hideOnSinglePage:true}}))),/*#__PURE__*/React.createElement(PaymentMethodModal,{ref:PaymentMethodRef}));};export default Plans;var Container=styled.div.withConfig({displayName:\"Plans__Container\",componentId:\"sc-1rpzp2j-0\"})([\"padding:0 15%;height:100%;overflow-y:auto;\"]);var Header=styled.div.withConfig({displayName:\"Plans__Header\",componentId:\"sc-1rpzp2j-1\"})([\"display:flex;flex-direction:row;align-items:center;justify-content:center;padding:10px 0;width:100%;\"]);var Text=styled.p.withConfig({displayName:\"Plans__Text\",componentId:\"sc-1rpzp2j-2\"})([\"margin:0;\"]);var SwitchStyled=styled(Switch).withConfig({displayName:\"Plans__SwitchStyled\",componentId:\"sc-1rpzp2j-3\"})([\"margin:0 10px;\"]);var StyledTable=styled(Table).withConfig({displayName:\"Plans__StyledTable\",componentId:\"sc-1rpzp2j-4\"})([\".ant-table-thead{th{border-bottom:2px solid \",\";padding:5px 0;background:white;}}.ant-table-body{height:100%;}.ant-table-body,.ant-table-row{td{padding:1.5px 0;border-bottom:unset;}:nth-last-child(2) td{padding-bottom:5px;border-bottom:2px solid \",\";}}\"],function(p){return p.theme.colors.dark_gray;},function(p){return p.theme.colors.dark_gray;});","map":null,"metadata":{},"sourceType":"module"}